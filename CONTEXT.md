# CONTEXT.md

## 📌 סקירה כללית
האפליקציה **ScreenToN8N** היא אפליקציית אנדרואיד קטנה שמטרתה:
1. לאפשר שיתוף צילום מסך (או תמונה אחרת) אל ה־Webhook של Make.com (לשעבר Integromat).
2. להעלות את הקובץ דרך Service (Foreground Service).
3. לקבל חזרה תשובת JSON מה־Webhook.
4. להציג את התוצאה ב־UI (נוטיפיקציה, ולוגים בתוך האפליקציה).

---

## 📌 מה כבר עובד (בגרסה שהעליתי ל־GitHub)
- **שיתוף תמונה**:  
  דרך Android Share → בחירה באפליקציה שלנו → התמונה נשלחת ל־Webhook.

- **UploadService**:  
  השירות (`UploadService`) מקבל את ה־Intent עם התמונה, מעלה אותה לכתובת ה־Webhook, ומחזיר את ה־Response.

- **התשובה מהשרת**:  
  מגיעה כ־JSON, נשמרת ב־SharedPreferences, ומוצגת בעת פתיחת `ViewDataActivity`.

- **נוטיפיקציה**:  
  יש נוטיפיקציה בסיסית על תהליך ההעלאה (Upload in progress).  
  חלק מהקוד כבר מוכן כדי להציג גם "View Data", אבל ייתכן שזה עדיין לא פועל ב־100%.

---

## 📌 מה חסר / לא עודכן בקוד הנוכחי
> ⚠️ חשוב: הגרסה הזאת היא גרסה **קודמת שעבדה**, אבל **עדיין לא כוללת** את כל השינויים האחרונים שעשינו בצ'אט.

- אין עדיין מסך **Settings** ייעודי.  
  כרגע ה־Webhook URL נמצא ישירות ב־`MainActivity` בתוך EditText.

- הנוטיפיקציה לא תמיד מציגה את התוכן שהתקבל.  
  צריך לחבר נכון בין ה־UploadService לבין Deep Link שמפעיל את `ViewDataActivity`.

- הלוגים (UI) עדיין בסיסיים: מוצג JSON גולמי ולא "לוג מסודר".  
  דיברנו על כך שנרצה:
    - להציג רק את הערכים עצמם, לא את כל הטקסט.
    - להוסיף גלילה חלקה.
    - להוסיף כפתור "נקה לוגים".

- יש קוד שמוכן להוספת Settings עם שמירה של כתובות Webhook אחרונות (history + מחיקה), אבל זה **עדיין לא ממומש** בקבצים ב־Repo הזה.

---

## 📌 קבצים עיקריים
- `AndroidManifest.xml`  
  כולל הרשאות (INTERNET, FOREGROUND_SERVICE, POST_NOTIFICATIONS).  
  מגדיר את ה־Activities וה־Service.

- `MainActivity.java`  
  מסך ראשי. כאן מגדירים את כתובת ה־Webhook (בגרסה זו עדיין ישירות ב־UI).

- `UploadService.java`  
  Foreground Service שמעלה את התמונה ומטפל בתשובה.

- `ShareBridgeActivity.java`  
  מקבל Intents של שיתוף תמונה.

- `ViewDataActivity.java`  
  מציג את ה־JSON שהתקבל (בגרסה הנוכחית יחסית בסיסי).

---

## 📌 מה נשאר לעשות
1. **UI**
    - להוסיף Settings Menu עם אייקון גלגל שיניים.
    - לאפשר שמירה של כמה כתובות Webhook (רשימה נפתחת + מחיקה).
    - לנקות את הלוגים בכפתור ייעודי.

2. **נוטיפיקציות**
    - לוודא שנשלחת נוטיפיקציה גם אחרי שה־Webhook החזיר תשובה, עם כפתור "View Data".
    - שהנוטיפיקציה לא תיעלם עד שהמשתמש יסגור/ילחץ.

3. **לוגים**
    - להפוך את הלוג למסודר: הצגת שדות מתוך JSON (phone, email, notes וכו').
    - להוסיף הפרדה בין הודעות.

---

## 📌 איך להמשיך מכאן
- כל מי שעובד עם הקוד הזה צריך לדעת:
    1. **הגרסה כאן יציבה** (מעלה תמונה ומחזירה JSON).
    2. אבל היא לא כוללת את **מסך ההגדרות** ואת שיפורי ה־UI.
    3. מי שרוצה לשפר, עדיף להוסיף בהדרגה:
        - קודם Settings.
        - אח"כ שדרוג Notifications.
        - בסוף ייפוי ה־Logs.

---

## 📌 הערה לסיום
הפרויקט עדיין צעיר 🙂  
המטרה ב־Repo הזה היא שתהיה לנו נקודת ייחוס עובדת.  
כל השיפורים (Settings, לוגים מסודרים, נוטיפיקציות חכמות) נבצע ב־Commits הבאים.

